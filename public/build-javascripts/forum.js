function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).pica=e()}}((function(){return function e(t,i,r){function n(o,s){if(!i[o]){if(!t[o]){var l="function"==typeof require&&require;if(!s&&l)return l(o,!0);if(a)return a(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var h=i[o]={exports:{}};t[o][0].call(h.exports,(function(e){var i=t[o][1][e];return n(i||e)}),h,h.exports,e,t,i,r)}return i[o].exports}for(var a="function"==typeof require&&require,o=0;o<r.length;o++)n(r[o]);return n}({1:[function(e,t,i){"use strict";t.exports=function(){return document.createElement("canvas")}},{}],2:[function(e,t,i){"use strict";var r=1;t.exports=function(){return r++}},{}],3:[function(e,t,i){"use strict";function r(e){this.create=e,this.available=[],this.acquired={},this.lastId=1,this.timeoutId=0}r.prototype.acquire=function(){var e,t=this;return 0!==this.available.length?e=this.available.pop():((e=this.create()).id=this.lastId++,e.release=function(){t.release(e)}),this.acquired[e.id]=e,e},r.prototype.release=function(e){delete this.acquired[e.id],e.lastUsed=Date.now(),this.available.push(e),0===this.timeoutId&&(this.timeoutId=setTimeout(this.gc.bind(this),500))},r.prototype.gc=function(){var e=Date.now();this.available=this.available.filter((function(t){return!(e-t.lastUsed>2e3&&(t.destroy(),1))})),0!==this.available.length?this.timeoutId=setTimeout(this.gc.bind(this),500):this.timeoutId=0},t.exports=r},{}],4:[function(e,t,i){"use strict";function r(e){return e<0?0:e>255?255:e}function n(e){return Math.round(e*((1<<l)-1))}function a(e,t,i,r,a){var o,s,l,h,c,d,f,g,p,m,v,b,w,y,E,S,x,T=u[e].filter,R=1/r,C=Math.min(1,r),_=u[e].win/C,I=Math.floor(2*(_+1)),P=new Int16Array((I+2)*i),M=0;for(o=0;o<i;o++){for(s=(o+.5)*R+a,l=Math.max(0,Math.floor(s-_)),c=(h=Math.min(t-1,Math.ceil(s+_)))-l+1,d=new Float32Array(c),f=new Int16Array(c),g=0,p=l,m=0;p<=h;p++,m++)g+=v=T((p+.5-s)*C),d[m]=v;for(b=0,m=0;m<d.length;m++)b+=w=d[m]/g,f[m]=n(w);for(f[i>>1]+=n(1-b),y=0;y<f.length&&0===f[y];)y++;if(y<f.length){for(E=f.length-1;E>0&&0===f[E];)E--;S=l+y,x=E-y+1,P[M++]=S,P[M++]=x,P.set(f.subarray(y,E+1),M),M+=x}else P[M++]=0,P[M++]=0}return P}function o(e,t,i,n,a,o){var s,l,u,h,c,d,f,g,p,m,v,b=0,w=0;for(p=0;p<n;p++){for(c=0,m=0;m<a;m++){for(d=o[c++],f=o[c++],g=b+4*d|0,s=l=u=h=0;f>0;f--)h=h+(v=o[c++])*e[g+3]|0,u=u+v*e[g+2]|0,l=l+v*e[g+1]|0,s=s+v*e[g]|0,g=g+4|0;t[w+3]=r(h+8192>>14),t[w+2]=r(u+8192>>14),t[w+1]=r(l+8192>>14),t[w]=r(s+8192>>14),w=w+4*n|0}w=4*(p+1)|0,b=(p+1)*i*4|0}}function s(e,t,i,n,a,o){var s,l,u,h,c,d,f,g,p,m,v,b=0,w=0;for(p=0;p<n;p++){for(c=0,m=0;m<a;m++){for(d=o[c++],f=o[c++],g=b+4*d|0,s=l=u=h=0;f>0;f--)h=h+(v=o[c++])*e[g+3]|0,u=u+v*e[g+2]|0,l=l+v*e[g+1]|0,s=s+v*e[g]|0,g=g+4|0;t[w+3]=r(h+8192>>14),t[w+2]=r(u+8192>>14),t[w+1]=r(l+8192>>14),t[w]=r(s+8192>>14),w=w+4*n|0}w=4*(p+1)|0,b=(p+1)*i*4|0}}var l=14,u=[{win:.5,filter:function(e){return e>=-.5&&e<.5?1:0}},{win:1,filter:function(e){if(e<=-1||e>=1)return 0;if(e>-1.1920929e-7&&e<1.1920929e-7)return 1;var t=e*Math.PI;return Math.sin(t)/t*(.54+.46*Math.cos(t/1))}},{win:2,filter:function(e){if(e<=-2||e>=2)return 0;if(e>-1.1920929e-7&&e<1.1920929e-7)return 1;var t=e*Math.PI;return Math.sin(t)/t*Math.sin(t/2)/(t/2)}},{win:3,filter:function(e){if(e<=-3||e>=3)return 0;if(e>-1.1920929e-7&&e<1.1920929e-7)return 1;var t=e*Math.PI;return Math.sin(t)/t*Math.sin(t/3)/(t/3)}}];t.exports=function(e){var t=e.src,i=e.width,r=e.height,n=e.toWidth,l=e.toHeight,u=e.scaleX||e.toWidth/e.width,h=e.scaleY||e.toHeight/e.height,c=e.offsetX||0,d=e.offsetY||0,f=e.dest||new Uint8Array(n*l*4),g=void 0===e.quality?3:e.quality,p=e.alpha||!1;if(i<1||r<1||n<1||l<1)return[];var m=a(g,i,n,u,c),v=a(g,r,l,h,d),b=new Uint8Array(n*r*4);return o(t,b,i,r,n,m),s(b,f,r,n,l,v),p||function(e,t,i){for(var r=3,n=t*i*4|0;r<n;)e[r]=255,r=r+4|0}(f,n,l),f}},{}],5:[function(e,t,i){"use strict";function r(e,t,i){for(var r,n,a,o,s,l=t*i,u=new Uint16Array(l),h=0;h<l;h++)r=e[4*h],n=e[4*h+1],a=e[4*h+2],s=r>=n&&r>=a?r:n>=a&&n>=r?n:a,o=r<=n&&r<=a?r:n<=a&&n<=r?n:a,u[h]=257*(s+o)>>1;return u}var n=e("glur/mono16");t.exports=function(e,t,i,a,o,s){var l,u,h,c,d,f,g,p,m,v,b,w,y;if(!(0===a||o<.5)){o>2&&(o=2);var E=r(e,t,i),S=new Uint16Array(E);n(S,t,i,o);for(var x=a/100*4096+.5|0,T=257*s|0,R=t*i,C=0;C<R;C++)w=2*(E[C]-S[C]),Math.abs(w)>=T&&(l=e[y=4*C],u=e[y+1],h=e[y+2],f=257*((p=l>=u&&l>=h?l:u>=l&&u>=h?u:h)+(g=l<=u&&l<=h?l:u<=l&&u<=h?u:h))>>1,g===p?c=d=0:(d=f<=32767?4095*(p-g)/(p+g)|0:4095*(p-g)/(510-p-g)|0,c=l===p?65535*(u-h)/(6*(p-g))|0:u===p?21845+(65535*(h-l)/(6*(p-g))|0):43690+(65535*(l-u)/(6*(p-g))|0)),(f+=x*w+2048>>12)>65535?f=65535:f<0&&(f=0),0===d?l=u=h=f>>8:(m=2*f-(v=f<=32767?f*(4096+d)+2048>>12:f+((65535-f)*d+2048>>12))>>8,v>>=8,l=(b=c+21845&65535)>=43690?m:b>=32767?m+(6*(v-m)*(43690-b)+32768>>16):b>=10922?v:m+(6*(v-m)*b+32768>>16),u=(b=65535&c)>=43690?m:b>=32767?m+(6*(v-m)*(43690-b)+32768>>16):b>=10922?v:m+(6*(v-m)*b+32768>>16),h=(b=c-21845&65535)>=43690?m:b>=32767?m+(6*(v-m)*(43690-b)+32768>>16):b>=10922?v:m+(6*(v-m)*b+32768>>16)),e[y]=l,e[y+1]=u,e[y+2]=h)}},t.exports.lightness=r},{"glur/mono16":11}],6:[function(e,t,i){"use strict";function r(e){var t=Math.round(e);return Math.abs(e-t)<a?t:Math.floor(e)}function n(e){var t=Math.round(e);return Math.abs(e-t)<a?t:Math.ceil(e)}var a=1e-5;t.exports.createRegions=function(e){var t,i,a,o,s,l,u,h=e.toWidth/e.width,c=e.toHeight/e.height,d=r(e.srcTileSize*h)-2*e.destTileBorder,f=r(e.srcTileSize*c)-2*e.destTileBorder,g=[];for(o=0;o<e.toHeight;o+=f)for(a=0;a<e.toWidth;a+=d)(t=a-e.destTileBorder)<0&&(t=0),t+(s=a+d+e.destTileBorder-t)>=e.toWidth&&(s=e.toWidth-t),(i=o-e.destTileBorder)<0&&(i=0),i+(l=o+f+e.destTileBorder-i)>=e.toHeight&&(l=e.toHeight-i),u={toX:t,toY:i,toWidth:s,toHeight:l,toInnerX:a,toInnerY:o,toInnerWidth:d,toInnerHeight:f,offsetX:t/h-r(t/h),offsetY:i/c-r(i/c),scaleX:h,scaleY:c,x:r(t/h),y:r(i/c),width:n(s/h),height:n(l/c)},g.push(u);return g},t.exports.eachLimit=function(e,t,i,r){function n(t){if(!s){if(t)return s=!0,void r(t);++o===e.length?r():a<e.length&&i(e[a++],n)}}0===e.length&&r();for(var a=0,o=0,s=!1;a<t&&a<e.length;)i(e[a++],n)}},{}],7:[function(e,t,i){"use strict";t.exports=function(t){var i=e("./resize_array"),r=e("./unsharp");t.onmessage=function(e){var n=e.data;n.dest=new Uint8Array(n.toWidth*n.toHeight*4),i(n),n.unsharpAmount&&r(n.dest,n.toWidth,n.toHeight,n.unsharpAmount,n.unsharpRadius,n.unsharpThreshold),t.postMessage({output:n.dest},[n.dest.buffer])}}},{"./resize_array":4,"./unsharp":5}],8:[function(e,t,i){"use strict";var r=e("./js/resize_array"),n=e("./js/unsharp"),a=e("./js/utils").createRegions,o=e("./js/utils").eachLimit,s=e("./js/generate_id"),l=e("./js/create_canvas"),u=1024,h=3;t.exports=function(e,t,i,c){var d=t.getContext("2d",{alpha:Boolean(i.alpha)}),f=l();f.width=Math.min(u,e.width),f.height=Math.min(u,e.height);var g=f.getContext("2d",{alpha:Boolean(i.alpha)});g.globalCompositeOperation="copy";var p=a({width:e.naturalWidth||e.width,height:e.naturalHeight||e.height,srcTileSize:u,toWidth:t.width,toHeight:t.height,destTileBorder:Math.ceil(Math.max(h,2.5*i.unsharpRadius|0))});return o(p,1,(function(t,a){g.drawImage(e,t.x,t.y,t.width,t.height,0,0,t.width,t.height);var o=g.getImageData(0,0,t.width,t.height),s=d.createImageData(t.toWidth,t.toHeight),l={src:o.data,dest:s.data,width:t.width,height:t.height,toWidth:t.toWidth,toHeight:t.toHeight,scaleX:t.scaleX,scaleY:t.scaleY,offsetX:t.offsetX,offsetY:t.offsetY,quality:i.quality,alpha:i.alpha,unsharpAmount:i.unsharpAmount,unsharpRadius:i.unsharpRadius,unsharpThreshold:i.unsharpThreshold};r(l),i.unsharpAmount&&n(l.dest,l.toWidth,l.toHeight,l.unsharpAmount,l.unsharpRadius,l.unsharpThreshold),d.putImageData(s,t.toX,t.toY,t.toInnerX-t.toX,t.toInnerY-t.toY,t.toInnerWidth,t.toInnerHeight),a()}),c),s()},t.exports.terminate=function(){}},{"./js/create_canvas":1,"./js/generate_id":2,"./js/resize_array":4,"./js/unsharp":5,"./js/utils":6}],9:[function(e,t,i){"use strict";var r=e("webworkify"),n=e("./js/worker.js"),a=e("./js/utils").createRegions,o=e("./js/utils").eachLimit,s=e("./js/generate_id"),l=e("./js/create_canvas"),u=e("./js/pool"),h=1024,c=3,d=!1;try{d=-1!==navigator.userAgent.indexOf("Safari")}catch(e){}var f=new u((function(){return{value:r(n),destroy:function(){if(this.value.terminate(),"undefined"!=typeof window){var e=window.URL||window.webkitURL||window.mozURL||window.msURL;e&&e.revokeObjectURL&&this.value.objectURL&&e.revokeObjectURL(this.value.objectURL)}}}})),g={};t.exports=function(e,t,i,r){var n=t.getContext("2d",{alpha:Boolean(i.alpha)}),u=l();u.width=Math.min(h,e.naturalWidth||e.width),u.height=Math.min(h,e.naturalHeight||e.height);var p=u.getContext("2d",{alpha:Boolean(i.alpha)});p.globalCompositeOperation="copy";var m=a({width:e.naturalWidth||e.width,height:e.naturalHeight||e.height,srcTileSize:h,toWidth:t.width,toHeight:t.height,destTileBorder:Math.ceil(Math.max(c,2.5*i.unsharpRadius|0))}),v=1;"undefined"!=typeof navigator&&(v=navigator.hardwareConcurrency||1);var b=i._id||s();return g[b]=!0,o(m,v,(function(t,r){p.drawImage(e,t.x,t.y,t.width,t.height,0,0,t.width,t.height);var a={src:p.getImageData(0,0,t.width,t.height).data,width:t.width,height:t.height,toWidth:t.toWidth,toHeight:t.toHeight,scaleX:t.scaleX,scaleY:t.scaleY,offsetX:t.offsetX,offsetY:t.offsetY,quality:i.quality,alpha:i.alpha,unsharpAmount:i.unsharpAmount,unsharpRadius:i.unsharpRadius,unsharpThreshold:i.unsharpThreshold},o=f.acquire();o.value.onmessage=function(e){var i,a,s,l,u;if(o.release(),g[b])if(e.data.err)r(e.data.err);else{if(s=n.createImageData(t.toWidth,t.toHeight),l=e.data.output,(u=s.data).set)u.set(l);else for(i=0,a=l.length;i<a;i++)u[i]=l[i];d?n.putImageData(s,t.toX,t.toY,t.toInnerX-t.toX,t.toInnerY-t.toY,t.toInnerWidth+1e-5,t.toInnerHeight+1e-5):n.putImageData(s,t.toX,t.toY,t.toInnerX-t.toX,t.toInnerY-t.toY,t.toInnerWidth,t.toInnerHeight),r()}else r(!0)},o.value.postMessage(a,[a.src.buffer])}),(function(e){g[b]&&(delete g[b],r(e))})),b},t.exports.terminate=function(e){g[e]&&delete g[e]}},{"./js/create_canvas":1,"./js/generate_id":2,"./js/pool":3,"./js/utils":6,"./js/worker.js":7,webworkify:13}],10:[function(e,t,i){"use strict";function r(e){try{(window.console.error||window.console.log).call(window.console,e)}catch(e){}}function n(e){var t=e.getError();if(t!==e.NO_ERROR)throw new Error("gl error "+t)}function a(e,t,i){var n=e.createShader(t);return e.shaderSource(n,i),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS)?n:(r("Shader compile error: "+e.getShaderInfoLog(n)+". Source: `"+i+"`"),e.deleteShader(n),null)}function o(e,t,i){var a=e.createProgram();return e.attachShader(a,t),e.attachShader(a,i),e.linkProgram(a),e.getProgramParameter(a,e.LINK_STATUS)||(r("Program linking error: "+e.getProgramInfoLog(a)),e.deleteProgram(a)),n(e),a}function s(e,t,i,r,a){var o=e.getAttribLocation(t,i);e.bindBuffer(e.ARRAY_BUFFER,e.createBuffer()),e.bufferData(e.ARRAY_BUFFER,new Float32Array(r),e.STATIC_DRAW),e.enableVertexAttribArray(o),e.vertexAttribPointer(o,a.elementSize,e.FLOAT,!1,0,0),n(e)}function l(e,t,i){var r=e.createTexture();return e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,i),n(e),r}function u(e,t,i,r){var a=function(e,t,i,r){var a=e.createTexture();return e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D,a),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,i,r,0,e.RGBA,e.UNSIGNED_BYTE,null),n(e),a}(e,t,i,r),o=e.getParameter(e.FRAMEBUFFER_BINDING),s=e.createFramebuffer();return e.bindFramebuffer(e.FRAMEBUFFER,s),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,a,0),n(e),{fbo:s,texture:a,oldFbo:o}}function h(e,t,i,r){var n=e+i,a=t+r;return[e,t,n,t,e,a,e,a,n,t,n,a]}function c(e,t){var i=a(e,e.VERTEX_SHADER,p["#vsh-basic"]),r=a(e,e.FRAGMENT_SHADER,function(e){function t(e){return e.toFixed(20)}for(var i=p["#fsh-lanczos1d-optimized-tpl"],r=e.direction,n=e.texW/e.destW,a=e.texH/e.destH,o="horizontal"===r?n:a,s=m[3].filter,l=m[3].win,u="horizontal"===r,h=1/e.texW,c=1/e.texH,d=u?h:c,f=2*Math.ceil(l*o),g="float total = 0.0;\ngl_FragColor = vec4(0.0);\n",v=0;v<f+1;v++){var b=v-f/2,w=s(b/o),y=d*b,E=u?0:y;g+="addPoint(vec2("+t(u?y:0)+", "+t(E)+"), "+t(w)+", total);\n"}return g+="gl_FragColor /= vec4(total);",i.replace("__CODE__",g)}(t));return o(e,i,r)}function d(e,t,i,r,a,o,l,d,f){var g=c(e,{direction:o,texW:i,texH:r,destW:l,destH:d});e.useProgram(g),function(e,t,i,r){var n=e.getUniformLocation(t,i);e.uniform1i(n,r)}(e,g,"u_image",t),function(e,t,i,r,n){var a=e.getUniformLocation(t,i);e.uniform2f(a,r,n)}(e,g,"u_resolution",l,d),s(e,g,"a_texCoord",[0,0,1,0,0,1,0,1,1,0,1,1],{elementSize:2}),s(e,g,"a_position",f?h(0,d,l,-d):h(0,0,l,d),{elementSize:2}),e.viewport(0,0,l,d);var p=u(e,a,l,d);return e.viewport(0,0,l,d),e.drawArrays(e.TRIANGLES,0,6),e.bindFramebuffer(e.FRAMEBUFFER,p.oldFbo),n(e),p}var f=e("./js/unsharp"),g=e("./js/generate_id"),p={"#vsh-basic":"precision highp float;\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\n\nuniform vec2 u_resolution;\n\nvarying vec2 v_texCoord;\n\nvoid main() {\n   vec2 clipSpace = a_position / u_resolution * 2.0 - 1.0;\n\n   gl_Position = vec4(clipSpace, 0, 1);\n   v_texCoord = a_texCoord;\n}\n","#fsh-lanczos1d-optimized-tpl":"precision highp float;\n\nvarying vec2 v_texCoord;\n\nuniform sampler2D u_image;\n\n#define addPoint(offset, kv, total)   {vec2 pos = v_texCoord + offset; gl_FragColor += texture2D(u_image, pos) * kv; total += kv; }\n\nvoid main()\n{\n__CODE__\n}\n"},m=[{win:.5,filter:function(e){return e>=-.5&&e<.5?1:0}},{win:1,filter:function(e){if(e<=-1||e>=1)return 0;if(e>-1.1920929e-7&&e<1.1920929e-7)return 1;var t=e*Math.PI;return Math.sin(t)/t*(.54+.46*Math.cos(t/1))}},{win:2,filter:function(e){if(e<=-2||e>=2)return 0;if(e>-1.1920929e-7&&e<1.1920929e-7)return 1;var t=e*Math.PI;return Math.sin(t)/t*Math.sin(t/2)/(t/2)}},{win:3,filter:function(e){if(e<=-3||e>=3)return 0;if(e>-1.1920929e-7&&e<1.1920929e-7)return 1;var t=e*Math.PI;return Math.sin(t)/t*Math.sin(t/3)/(t/3)}}];t.exports=function(e,t,i,n){var a,o;try{(o=document.createElement("canvas")).id="pica-webgl-temporarry-canvas",o.height=t.height,o.width=t.width,document.body.appendChild(o),a=function(e){return e.getContext("webgl")||e.getContext("experimental-webgl")}(o);var s=function(e,t,i){var r=e.naturalWidth||e.width,n=e.naturalHeight||e.height,a=t.canvas.width,o=t.canvas.height;l(t,0,e),d(t,0,r,n,1,"horizontal",a,n,!1);var s=d(t,1,a,n,2,"vertical",a,o,!0);t.flush();var u=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,u),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,s.texture,0);var h=t.checkFramebufferStatus(t.FRAMEBUFFER);if(h!==t.FRAMEBUFFER_COMPLETE)throw new Error("Bad framebuffer status: "+h);i.alpha||(t.clearColor(1,1,1,1),t.colorMask(!1,!1,!1,!0),t.clear(t.COLOR_BUFFER_BIT));var c=new Uint8Array(a*o*4);t.readPixels(0,0,a,o,t.RGBA,t.UNSIGNED_BYTE,c);var g=void 0===i.unsharpAmount?0:0|i.unsharpAmount,p=void 0===i.unsharpRadius?0:i.unsharpRadius,m=void 0===i.unsharpThreshold?0:0|i.unsharpThreshold;return g&&f(c,a,o,g,p,m),c}(e,a,i);a.finish(),document.body.removeChild(o);var u=t.getContext("2d"),h=u.createImageData(t.width,t.height);h.data.set(s),u.putImageData(h,0,0),n(null,s)}catch(e){r(e),a.finish(),document.body.removeChild(o),n(e)}return g()},t.exports.terminate=function(){}},{"./js/generate_id":2,"./js/unsharp":5}],11:[function(e,t,i){function r(e){e<.5&&(e=.5);var t=Math.exp(.527076)/e,i=Math.exp(-t),r=Math.exp(-2*t),n=(1-i)*(1-i)/(1+2*t*i-r);return a=n,o=n*(t-1)*i,s=n*(t+1)*i,l=-n*r,u=2*i,h=-r,new Float32Array([a,o,s,l,u,h,(a+o)/(1-u-h),(s+l)/(1-u-h)])}function n(e,t,i,r,n,a){var o,s,l,u,h,c,d,f,g,p,m,v,b,w;for(g=0;g<a;g++){for(d=g,f=0,u=h=(o=e[c=g*n])*r[6],m=r[0],v=r[1],b=r[4],w=r[5],p=0;p<n;p++)l=(s=e[c])*m+o*v+u*b+h*w,h=u,u=l,o=s,i[f]=u,f++,c++;for(f--,d+=a*(n-1),u=h=(o=e[--c])*r[7],s=o,m=r[2],v=r[3],p=n-1;p>=0;p--)l=s*m+o*v+u*b+h*w,h=u,u=l,o=s,s=e[c],t[d]=i[f]+u,c--,f--,d-=a}}var a,o,s,l,u,h;t.exports=function(e,t,i,a){if(a){var o=new Uint16Array(e.length),s=new Float32Array(Math.max(t,i)),l=r(a);n(e,o,s,l,t,i),n(o,e,s,l,i,t)}}},{}],12:[function(e,t,i){"use strict";function r(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}var n=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable;t.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},i=0;i<10;i++)t["_"+String.fromCharCode(i)]=i;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var i,o,s=r(e),l=1;l<arguments.length;l++){for(var u in i=Object(arguments[l]))n.call(i,u)&&(s[u]=i[u]);if(Object.getOwnPropertySymbols){o=Object.getOwnPropertySymbols(i);for(var h=0;h<o.length;h++)a.call(i,o[h])&&(s[o[h]]=i[o[h]])}}return s}},{}],13:[function(e,t,i){var r=arguments[3],n=arguments[4],a=arguments[5],o=JSON.stringify;t.exports=function(e,t){for(var i,s=Object.keys(a),l=0,u=s.length;l<u;l++){var h=s[l],c=a[h].exports;if(c===e||c&&c.default===e){i=h;break}}if(!i){i=Math.floor(Math.pow(16,8)*Math.random()).toString(16);var d={};for(l=0,u=s.length;l<u;l++){d[h=s[l]]=h}n[i]=[Function(["require","module","exports"],"("+e+")(self)"),d]}var f=Math.floor(Math.pow(16,8)*Math.random()).toString(16),g={};g[i]=i,n[f]=[Function(["require"],"var f = require("+o(i)+");(f.default ? f.default : f)(self);"),g];var p={};!function e(t){for(var i in p[t]=!0,n[t][1]){var r=n[t][1][i];p[r]||e(r)}}(f);var m="("+r+")({"+Object.keys(p).map((function(e){return o(e)+":["+n[e][0]+","+o(n[e][1])+"]"})).join(",")+"},{},["+o(f)+"])",v=window.URL||window.webkitURL||window.mozURL||window.msURL,b=new Blob([m],{type:"text/javascript"});if(t&&t.bare)return b;var w=v.createObjectURL(b),y=new Worker(w);return y.objectURL=w,y}},{}],"/":[function(e,t,i){"use strict";function r(e){return"[object Function]"===function(e){return Object.prototype.toString.call(e)}(e)}var n="undefined"!=typeof window&&"Worker"in window;if(n)try{e("webworkify")((function(){})).terminate()}catch(e){n=!1}var a,o=!1;try{"undefined"!=typeof document&&"undefined"!=typeof window&&window.WebGLRenderingContext&&(((a=document.createElement("canvas")).getContext("webgl")||a.getContext("experimental-webgl"))&&(o=!0))}catch(e){}finally{a=null}var s=e("./lib/resize_js"),l=e("./lib/resize_js_ww"),u=e("./lib/resize_webgl"),h=e("./lib/js/resize_array"),c=e("./lib/js/unsharp"),d=e("object-assign");i.resizeCanvas=function e(t,a,h,c){if(r(h)&&(c=h,h={}),isNaN(h)||(h={quality:h,alpha:!1}),o||(i.WEBGL=!1),o&&i.WEBGL){i.debug("Resize canvas with WebGL");var f=u(t,a,h,(function(r){r?(i.debug("WebGL resize failed, do fallback and cancel next attempts"),i.debug(r),o=!1,e(t,a,d({},h,{_id:f}),c)):c()}));return f}return n||(i.WW=!1),n&&i.WW?(i.debug("Resize buffer in WebWorker"),l(t,a,h,c)):(i.debug("Resize buffer sync (freeze event loop)"),s(t,a,h,c))},i.resizeBuffer=function(e,t){var i={src:e.src,dest:e.dest,width:0|e.width,height:0|e.height,toWidth:0|e.toWidth,toHeight:0|e.toHeight,quality:e.quality,alpha:e.alpha,unsharpAmount:e.unsharpAmount,unsharpRadius:e.unsharpRadius,unsharpThreshold:e.unsharpThreshold};i.dest=h(i),i.unsharpAmount&&c(i.dest,i.toWidth,i.toHeight,i.unsharpAmount,i.unsharpRadius,i.unsharpThreshold),t(null,i.dest)},i.terminate=function(e){s.terminate(e),l.terminate(e),u.terminate(e)},i.WW=n,i.WEBGL=!1,i.debug=function(){}},{"./lib/js/resize_array":4,"./lib/js/unsharp":5,"./lib/resize_js":8,"./lib/resize_js_ww":9,"./lib/resize_webgl":10,"object-assign":12,webworkify:13}]},{},[])("/")}));var FlipDown=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"flipdown",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(_classCallCheck(this,e),"number"!=typeof t)throw new Error("FlipDown: Constructor expected unix timestamp, got ".concat(_typeof(t)," instead."));"object"===_typeof(i)&&(r=i,i="flipdown"),this.version="0.3.2",this.initialised=!1,this.now=this._getTime(),this.epoch=t,this.countdownEnded=!1,this.hasEndedCallback=null,this.element=document.getElementById(i),this.rotors=[],this.rotorLeafFront=[],this.rotorLeafRear=[],this.rotorTops=[],this.rotorBottoms=[],this.countdown=null,this.daysRemaining=0,this.clockValues={},this.clockStrings={},this.clockValuesAsString=[],this.prevClockValuesAsString=[],this.opts=this._parseOptions(r),this._setOptions(),console.log("FlipDown ".concat(this.version," (Theme: ").concat(this.opts.theme,")"))}return _createClass(e,[{key:"start",value:function(){return this.initialised||this._init(),this.countdown=setInterval(this._tick.bind(this),1e3),this}},{key:"ifEnded",value:function(e){return this.hasEndedCallback=function(){e(),this.hasEndedCallback=null},this}},{key:"_getTime",value:function(){return(new Date).getTime()/1e3}},{key:"_hasCountdownEnded",value:function(){return this.epoch-this.now<0?(this.countdownEnded=!0,null!=this.hasEndedCallback&&(this.hasEndedCallback(),this.hasEndedCallback=null),!0):(this.countdownEnded=!1,!1)}},{key:"_parseOptions",value:function(e){var t=["Days","Hours","Minutes","Seconds"];return e.headings&&4===e.headings.length&&(t=e.headings),{theme:e.hasOwnProperty("theme")?e.theme:"dark",headings:t}}},{key:"_setOptions",value:function(){this.element.classList.add("flipdown__theme-".concat(this.opts.theme))}},{key:"_init",value:function(){this.initialised=!0,this._hasCountdownEnded()?this.daysremaining=0:this.daysremaining=Math.floor((this.epoch-this.now)/86400).toString().length;for(var e=this.daysremaining<=2?2:this.daysremaining,t=0;t<e+6;t++)this.rotors.push(this._createRotor(0));var i=[];for(t=0;t<e;t++)i.push(this.rotors[t]);this.element.appendChild(this._createRotorGroup(i,0));var r=e;for(t=0;t<3;t++){for(var n=[],a=0;a<2;a++)n.push(this.rotors[r]),r++;this.element.appendChild(this._createRotorGroup(n,t+1))}return this.rotorLeafFront=Array.prototype.slice.call(this.element.getElementsByClassName("rotor-leaf-front")),this.rotorLeafRear=Array.prototype.slice.call(this.element.getElementsByClassName("rotor-leaf-rear")),this.rotorTop=Array.prototype.slice.call(this.element.getElementsByClassName("rotor-top")),this.rotorBottom=Array.prototype.slice.call(this.element.getElementsByClassName("rotor-bottom")),this._tick(),this._updateClockValues(!0),this}},{key:"_createRotorGroup",value:function(e,t){var i=document.createElement("div");i.className="rotor-group";var r=document.createElement("div");return r.className="rotor-group-heading",r.setAttribute("data-before",this.opts.headings[t]),i.appendChild(r),appendChildren(i,e),i}},{key:"_createRotor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=document.createElement("div"),i=document.createElement("div"),r=document.createElement("figure"),n=document.createElement("figure"),a=document.createElement("div"),o=document.createElement("div");return t.className="rotor",i.className="rotor-leaf",r.className="rotor-leaf-rear",n.className="rotor-leaf-front",a.className="rotor-top",o.className="rotor-bottom",r.textContent=e,a.textContent=e,o.textContent=e,appendChildren(t,[i,a,o]),appendChildren(i,[r,n]),t}},{key:"_tick",value:function(){this.now=this._getTime();var e=this.epoch-this.now<=0?0:this.epoch-this.now;this.clockValues.d=Math.floor(e/86400),e-=86400*this.clockValues.d,this.clockValues.h=Math.floor(e/3600),e-=3600*this.clockValues.h,this.clockValues.m=Math.floor(e/60),e-=60*this.clockValues.m,this.clockValues.s=Math.floor(e),this._updateClockValues(),this._hasCountdownEnded()}},{key:"_updateClockValues",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];function i(){var e=this;this.rotorTop.forEach((function(t,i){t.textContent!=e.clockValuesAsString[i]&&(t.textContent=e.clockValuesAsString[i])}))}function r(){var e=this;this.rotorLeafRear.forEach((function(t,i){if(t.textContent!=e.clockValuesAsString[i]){t.textContent=e.clockValuesAsString[i],t.parentElement.classList.add("flipped");var r=setInterval(function(){t.parentElement.classList.remove("flipped"),clearInterval(r)}.bind(e),500)}}))}this.clockStrings.d=pad(this.clockValues.d,2),this.clockStrings.h=pad(this.clockValues.h,2),this.clockStrings.m=pad(this.clockValues.m,2),this.clockStrings.s=pad(this.clockValues.s,2),this.clockValuesAsString=(this.clockStrings.d+this.clockStrings.h+this.clockStrings.m+this.clockStrings.s).split(""),this.rotorLeafFront.forEach((function(t,i){t.textContent=e.prevClockValuesAsString[i]})),this.rotorBottom.forEach((function(t,i){t.textContent=e.prevClockValuesAsString[i]})),t?(i.call(this),r.call(this)):(setTimeout(i.bind(this),500),setTimeout(r.bind(this),500)),this.prevClockValuesAsString=this.clockValuesAsString}}]),e}();function pad(e,t){return(e=e.toString()).length<t?pad("0"+e,t):e}function appendChildren(e,t){t.forEach((function(t){e.appendChild(t)}))}!function(e){"use strict";var t=function(e,i,r){var n,a,o=document.createElement("img");if(o.onerror=i,o.onload=function(){!a||r&&r.noRevoke||t.revokeObjectURL(a),i&&i(t.scale(o,r))},t.isInstanceOf("Blob",e)||t.isInstanceOf("File",e))n=a=t.createObjectURL(e),o._type=e.type;else{if("string"!=typeof e)return!1;n=e,r&&r.crossOrigin&&(o.crossOrigin=r.crossOrigin)}return n?(o.src=n,o):t.readFile(e,(function(e){var t=e.target;t&&t.result?o.src=t.result:i&&i(e)}))},i=window.createObjectURL&&window||window.URL&&URL.revokeObjectURL&&URL||window.webkitURL&&webkitURL;t.isInstanceOf=function(e,t){return Object.prototype.toString.call(t)==="[object "+e+"]"},t.transformCoordinates=function(){},t.getTransformedOptions=function(e,t){var i,r,n,a,o=t.aspectRatio;if(!o)return t;for(r in i={},t)t.hasOwnProperty(r)&&(i[r]=t[r]);return i.crop=!0,(n=e.naturalWidth||e.width)/(a=e.naturalHeight||e.height)>o?(i.maxWidth=a*o,i.maxHeight=a):(i.maxWidth=n,i.maxHeight=n/o),i},t.renderImageToCanvas=function(e,t,i,r,n,a,o,s,l,u){return e.getContext("2d").drawImage(t,i,r,n,a,o,s,l,u),e},t.hasCanvasOption=function(e){return e.canvas||e.crop||!!e.aspectRatio},t.scale=function(e,i){function r(){var e=Math.max((s||y)/y,(l||E)/E);e>1&&(y*=e,E*=e)}function n(){var e=Math.min((a||y)/y,(o||E)/E);1>e&&(y*=e,E*=e)}i=i||{};var a,o,s,l,u,h,c,d,f,g,p,m=document.createElement("canvas"),v=e.getContext||t.hasCanvasOption(i)&&m.getContext,b=e.naturalWidth||e.width,w=e.naturalHeight||e.height,y=b,E=w;if(v&&(c=(i=t.getTransformedOptions(e,i)).left||0,d=i.top||0,i.sourceWidth?(u=i.sourceWidth,void 0!==i.right&&void 0===i.left&&(c=b-u-i.right)):u=b-c-(i.right||0),i.sourceHeight?(h=i.sourceHeight,void 0!==i.bottom&&void 0===i.top&&(d=w-h-i.bottom)):h=w-d-(i.bottom||0),y=u,E=h),a=i.maxWidth,o=i.maxHeight,s=i.minWidth,l=i.minHeight,v&&a&&o&&i.crop?(y=a,E=o,0>(p=u/h-a/o)?(h=o*u/a,void 0===i.top&&void 0===i.bottom&&(d=(w-h)/2)):p>0&&(u=a*h/o,void 0===i.left&&void 0===i.right&&(c=(b-u)/2))):((i.contain||i.cover)&&(s=a=a||s,l=o=o||l),i.cover?(n(),r()):(r(),n())),v){if((f=i.pixelRatio)>1&&(m.style.width=y+"px",m.style.height=E+"px",y*=f,E*=f,m.getContext("2d").scale(f,f)),(g=i.downsamplingRatio)>0&&1>g&&u>y&&h>E)for(;u*g>y;)m.width=u*g,m.height=h*g,t.renderImageToCanvas(m,e,c,d,u,h,0,0,m.width,m.height),u=m.width,h=m.height,(e=document.createElement("canvas")).width=u,e.height=h,t.renderImageToCanvas(e,m,0,0,u,h,0,0,u,h);return m.width=y,m.height=E,t.transformCoordinates(m,i),t.renderImageToCanvas(m,e,c,d,u,h,0,0,y,E)}return e.width=y,e.height=E,e},t.createObjectURL=function(e){return!!i&&i.createObjectURL(e)},t.revokeObjectURL=function(e){return!!i&&i.revokeObjectURL(e)},t.readFile=function(e,t,i){if(window.FileReader){var r=new FileReader;if(r.onload=r.onerror=t,r[i=i||"readAsDataURL"])return r[i](e),r}return!1},"function"==typeof define&&define.amd?define((function(){return t})):"object"==typeof module&&module.exports?module.exports=t:e.loadImage=t}(window),function(e){"use strict";"function"==typeof define&&define.amd?define(["./load-image"],e):e("object"==typeof module&&module.exports?require("./load-image"):window.loadImage)}((function(e){"use strict";var t=e.hasCanvasOption,i=e.transformCoordinates,r=e.getTransformedOptions;e.hasCanvasOption=function(i){return!!i.orientation||t.call(e,i)},e.transformCoordinates=function(t,r){i.call(e,t,r);var n=t.getContext("2d"),a=t.width,o=t.height,s=t.style.width,l=t.style.height,u=r.orientation;if(u&&!(u>8))switch(u>4&&(t.width=o,t.height=a,t.style.width=l,t.style.height=s),u){case 2:n.translate(a,0),n.scale(-1,1);break;case 3:n.translate(a,o),n.rotate(Math.PI);break;case 4:n.translate(0,o),n.scale(1,-1);break;case 5:n.rotate(.5*Math.PI),n.scale(1,-1);break;case 6:n.rotate(.5*Math.PI),n.translate(0,-o);break;case 7:n.rotate(.5*Math.PI),n.translate(a,-o),n.scale(-1,1);break;case 8:n.rotate(-.5*Math.PI),n.translate(-a,0)}},e.getTransformedOptions=function(t,i){var n,a,o=r.call(e,t,i),s=o.orientation;if(!s||s>8||1===s)return o;for(a in n={},o)o.hasOwnProperty(a)&&(n[a]=o[a]);switch(o.orientation){case 2:n.left=o.right,n.right=o.left;break;case 3:n.left=o.right,n.top=o.bottom,n.right=o.left,n.bottom=o.top;break;case 4:n.top=o.bottom,n.bottom=o.top;break;case 5:n.left=o.top,n.top=o.left,n.right=o.bottom,n.bottom=o.right;break;case 6:n.left=o.top,n.top=o.right,n.right=o.bottom,n.bottom=o.left;break;case 7:n.left=o.bottom,n.top=o.right,n.right=o.top,n.bottom=o.left;break;case 8:n.left=o.bottom,n.top=o.left,n.right=o.top,n.bottom=o.right}return o.orientation>4&&(n.maxWidth=o.maxHeight,n.maxHeight=o.maxWidth,n.minWidth=o.minHeight,n.minHeight=o.minWidth,n.sourceWidth=o.sourceHeight,n.sourceHeight=o.sourceWidth),n}})),function(e){"use strict";"function"==typeof define&&define.amd?define(["./load-image"],e):e("object"==typeof module&&module.exports?require("./load-image"):window.loadImage)}((function(e){"use strict";var t=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);e.blobSlice=t&&function(){var e=this.slice||this.webkitSlice||this.mozSlice;return e.apply(this,arguments)},e.metaDataParsers={jpeg:{65505:[]}},e.parseMetaData=function(t,i,r){var n=this,a=(r=r||{}).maxMetaDataSize||262144,o={};(!(window.DataView&&t&&t.size>=12&&"image/jpeg"===t.type&&e.blobSlice)||!e.readFile(e.blobSlice.call(t,0,a),(function(t){if(t.target.error)return console.log(t.target.error),void i(o);var a,s,l,u,h=t.target.result,c=new DataView(h),d=2,f=c.byteLength-4,g=d;if(65496===c.getUint16(0)){for(;f>d&&((a=c.getUint16(d))>=65504&&65519>=a||65534===a);){if(d+(s=c.getUint16(d+2)+2)>c.byteLength){console.log("Invalid meta data: Invalid segment size.");break}if(l=e.metaDataParsers.jpeg[a])for(u=0;u<l.length;u+=1)l[u].call(n,c,d,s,o,r);g=d+=s}!r.disableImageHead&&g>6&&(h.slice?o.imageHead=h.slice(0,g):o.imageHead=new Uint8Array(h).subarray(0,g))}else console.log("Invalid JPEG file: Missing JPEG marker.");i(o)}),"readAsArrayBuffer"))&&i(o)}})),function(e){"use strict";"function"==typeof define&&define.amd?define(["./load-image","./load-image-meta"],e):"object"==typeof module&&module.exports?e(require("./load-image"),require("./load-image-meta")):e(window.loadImage)}((function(e){"use strict";e.ExifMap=function(){return this},e.ExifMap.prototype.map={Orientation:274},e.ExifMap.prototype.get=function(e){return this[e]||this[this.map[e]]},e.getExifThumbnail=function(e,t,i){var r,n,a;if(i&&!(t+i>e.byteLength)){for(r=[],n=0;i>n;n+=1)a=e.getUint8(t+n),r.push((16>a?"0":"")+a.toString(16));return"data:image/jpeg,%"+r.join("%")}console.log("Invalid Exif data: Invalid thumbnail data.")},e.exifTagTypes={1:{getValue:function(e,t){return e.getUint8(t)},size:1},2:{getValue:function(e,t){return String.fromCharCode(e.getUint8(t))},size:1,ascii:!0},3:{getValue:function(e,t,i){return e.getUint16(t,i)},size:2},4:{getValue:function(e,t,i){return e.getUint32(t,i)},size:4},5:{getValue:function(e,t,i){return e.getUint32(t,i)/e.getUint32(t+4,i)},size:8},9:{getValue:function(e,t,i){return e.getInt32(t,i)},size:4},10:{getValue:function(e,t,i){return e.getInt32(t,i)/e.getInt32(t+4,i)},size:8}},e.exifTagTypes[7]=e.exifTagTypes[1],e.getExifValue=function(t,i,r,n,a,o){var s,l,u,h,c,d,f=e.exifTagTypes[n];if(f){if(!((l=(s=f.size*a)>4?i+t.getUint32(r+8,o):r+8)+s>t.byteLength)){if(1===a)return f.getValue(t,l,o);for(u=[],h=0;a>h;h+=1)u[h]=f.getValue(t,l+h*f.size,o);if(f.ascii){for(c="",h=0;h<u.length&&"\0"!==(d=u[h]);h+=1)c+=d;return c}return u}console.log("Invalid Exif data: Invalid data offset.")}else console.log("Invalid Exif data: Invalid tag type.")},e.parseExifTag=function(t,i,r,n,a){var o=t.getUint16(r,n);a.exif[o]=e.getExifValue(t,i,r,t.getUint16(r+2,n),t.getUint32(r+4,n),n)},e.parseExifTags=function(e,t,i,r,n){var a,o,s;if(i+6>e.byteLength)console.log("Invalid Exif data: Invalid directory offset.");else{if(!((o=i+2+12*(a=e.getUint16(i,r)))+4>e.byteLength)){for(s=0;a>s;s+=1)this.parseExifTag(e,t,i+2+12*s,r,n);return e.getUint32(o,r)}console.log("Invalid Exif data: Invalid directory size.")}},e.parseExifData=function(t,i,r,n,a){if(!a.disableExif){var o,s,l,u=i+10;if(1165519206===t.getUint32(i+4)){if(u+8>t.byteLength)return void console.log("Invalid Exif data: Invalid segment size.");if(0!==t.getUint16(i+8))return void console.log("Invalid Exif data: Missing byte alignment offset.");switch(t.getUint16(u)){case 18761:o=!0;break;case 19789:o=!1;break;default:return void console.log("Invalid Exif data: Invalid byte alignment marker.")}if(42!==t.getUint16(u+2,o))return void console.log("Invalid Exif data: Missing TIFF marker.");s=t.getUint32(u+4,o),n.exif=new e.ExifMap,(s=e.parseExifTags(t,u,u+s,o,n))&&!a.disableExifThumbnail&&(l={exif:{}},s=e.parseExifTags(t,u,u+s,o,l),l.exif[513]&&(n.exif.Thumbnail=e.getExifThumbnail(t,u+l.exif[513],l.exif[514]))),n.exif[34665]&&!a.disableExifSub&&e.parseExifTags(t,u,u+n.exif[34665],o,n),n.exif[34853]&&!a.disableExifGps&&e.parseExifTags(t,u,u+n.exif[34853],o,n)}}},e.metaDataParsers.jpeg[65505].push(e.parseExifData)})),function(e){"use strict";"function"==typeof define&&define.amd?define(["./load-image","./load-image-exif"],e):"object"==typeof module&&module.exports?e(require("./load-image"),require("./load-image-exif")):e(window.loadImage)}((function(e){"use strict";e.ExifMap.prototype.tags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright",36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",42240:"Gamma",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubSecTime",37521:"SubSecTimeOriginal",37522:"SubSecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"PhotographicSensitivity",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"},e.ExifMap.prototype.stringValues={ExposureProgram:{0:"Undefined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Undefined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},ComponentsConfiguration:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"},Orientation:{1:"top-left",2:"top-right",3:"bottom-right",4:"bottom-left",5:"left-top",6:"right-top",7:"right-bottom",8:"left-bottom"}},e.ExifMap.prototype.getText=function(e){var t=this.get(e);switch(e){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":case"Orientation":return this.stringValues[e][t];case"ExifVersion":case"FlashpixVersion":return String.fromCharCode(t[0],t[1],t[2],t[3]);case"ComponentsConfiguration":return this.stringValues[e][t[0]]+this.stringValues[e][t[1]]+this.stringValues[e][t[2]]+this.stringValues[e][t[3]];case"GPSVersionID":return t[0]+"."+t[1]+"."+t[2]+"."+t[3]}return String(t)},function(e){var t,i=e.tags,r=e.map;for(t in i)i.hasOwnProperty(t)&&(r[i[t]]=t)}(e.ExifMap.prototype),e.ExifMap.prototype.getAll=function(){var e,t,i={};for(e in this)this.hasOwnProperty(e)&&((t=this.tags[e])&&(i[t]=this.getText(t)));return i}}));var Upload=function(){var e=document.getElementById("imgur-file-upload"),t=document.getElementById("forum-editor-form"),i=document.getElementById("body"),r=document.getElementById("imgur-help-text");function n(e){r.innerHTML="bezig...";var t=document.createElement("canvas");loadImage.parseMetaData(e,(function(n){var a={canvas:!0};n.exif&&(a.orientation=n.exif.get("Orientation")),loadImage(e,(function(n){var a=Math.min(n.width,631),o=n.height*a/n.width;t.width=a,t.height=o,pica.resizeCanvas(n,t,(function(){t.toBlob((function(e){var t=new XMLHttpRequest,n=new FormData;n.append("type","file"),n.append("image",e),t.open("POST","https://api.imgur.com/3/image",!0),t.setRequestHeader("Authorization","Client-ID c9fd3e097596f79"),t.setRequestHeader("Accept","application/json"),t.addEventListener("load",(function(){r.innerHTML="klik of sleep";var e=JSON.parse(this.responseText).data.link.replace(/^http:/,"");i.value+="\n![beschrijving]("+e+")"})),t.send(n)}),e.type,.8)}))}),a)}))}t.addEventListener("dragover",(function(e){e.preventDefault()}),!0),t.addEventListener("drop",(function(e){e.preventDefault(),n(e.dataTransfer.files[0])}),!0),e.addEventListener("change",(function(e){n(e.target.files[0])}))}();